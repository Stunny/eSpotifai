<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
package database;

import java.security.Timestamp;
import java.sql.Date;
=======
<<<<<<< HEAD
package database;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.LinkedList;

import customExceptions.DatabaseNotLoadedException;
import model.Playlist;
import model.Song;
import model.User;

public class DDBBConnection {
	DataBase ddbb;
	
	/*
	 * Contructor que crea la clase DataBase que permite la conexión y modificación con la base de datos.
	 */
	public DDBBConnection (String username, String password, String ddbbName, int port){
		ddbb = new DataBase(username, password, ddbbName, port);
	}
	
	/*
	 * Conexión con el servidor 
	 */
	public void startConnection() throws DatabaseNotLoadedException {
		ddbb.connect();
	}
	
	/*
	 * Desconexion con el servidor 
	 */
	public void stopConnection (){
		ddbb.disconnect();	
	}
	
	/*
	 * Busca si el usuario existe en la base de datos y comprueba si la contraseña es correcta.
	 * Posibilidades: 
	 * 		"Incorrect username" -> Usuario no encontrado 
	 * 		"Welcome" -> Usuario enncontrado y la contraseña coincide
	 * 		"Incorrect password" -> Usuario encontrado pero la contraseá no coincide
	 */
	public String userConnection(String username, String password){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			if (dontExist == 0 && !username.equals("username")){
				return "Incorrect username";
			}
			
			else {
				resultSet= ddbb.selectQuery("SELECT user_name, password FROM users WHERE user_name like '"+ username +"'");
				resultSet.next();
				if (password.equals(resultSet.getObject("password")) || password.equals("password")){
					updateLastAccess(username);
					return "Welcome";
				}
				else {
					return "Incorrect password";
				}
			}
		} catch (SQLException e) {
				// TODO Auto-generated catch block
				return "Problems";
		}
		
	}
	
	/*
	 * Devuelve un String que todos los usuarios con sus respectivos datos
	 * Formato: Name/Fecha de registro/Fecha de la última conexión/contraseña
	 */
	public LinkedList<User> getUsers(){
		ResultSet resultSet = ddbb.selectQuery("SELECT * FROM users");
		LinkedList<User> list = new LinkedList<User> ();
		
		try {
			//Recorrem el ResultSet que ens retorna el selectQuery i agafem els paràmetres desitjats
			while (resultSet.next())
			{
			    //Per recuperar el valor utilitzem la funció .getObject() amb el nom del camp a recuperar
				SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
				java.sql.Timestamp aux = (java.sql.Timestamp) resultSet.getObject("date_reg");
				String string  = dateFormat.format(aux);
				
				aux = (java.sql.Timestamp) resultSet.getObject("date_last_acces");
				String string2  = dateFormat.format(aux);
				
				list.add(new User ((int)resultSet.getObject("id_user"), (String) resultSet.getObject("user_name"), string, string2, (String)resultSet.getObject("password")));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Error al recuperar los usuarios de la base de datos");
		}
		return list;
	}
	
	public LinkedList<Object[]> getUsersDates(){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list = new LinkedList<Object[]>();
		for (int i = 0; i < userList.size(); i++){
			Object[] objs = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
							userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
							totalSongs(userList.get(i).getId()),
							nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
			list.add(objs);
		}
		return list;
	}

	public String getName(int id){
		LinkedList<User> userList = getUsers();
		for (int i = 0; i<userList.size(); i++){
			if (userList.get(i).getId()== id){
				return userList.get(i).getUsername();
			}
		}
		return "Desconocido";
	}

	public LinkedList<Object[]> getFollowersDates(int id){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_followed="+id);
			while (resultSet.next())
				{
					for (int i = 0; i < userList.size(); i++){
						if (userList.get(i).getId() == resultSet.getInt(1)){
							Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
									userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
									totalSongs(userList.get(i).getId()),
									nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
							list.add(obj);
						}
		
					}
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	public LinkedList<Object[]> getPlaylistDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT (*) FROM playlists WHERE creato_user="+id);
			while (resultSet.next())
				{
						Object[] obj = {resultSet.getObject("id_playlist"), resultSet.getObject("name")};
						list.add(obj);
		
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	public LinkedList<Playlist> getPlaylists(){
		LinkedList<Playlist> list = new LinkedList<Playlist>();
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists");
			while (resultSet.next())
				{
				ResultSet resultSet2 = ddbb.selectQuery("SELECT user_name FROM users WHERE id_user="+(int)resultSet.getObject("creator_user"));
				resultSet2.next();
				Playlist playlist = new Playlist((int)resultSet.getObject("id_playlist"), (String)resultSet.getObject("name"), (String)resultSet2.getObject("user_name"));
				list.add(playlist);
				}
		
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
			return list;
	}
	
	public LinkedList<Playlist> getPublicPlaylists(int id){
		LinkedList<Playlist> list = new LinkedList<Playlist>();
		try {
			System.out.println("id: "+id);
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM followers WHERE user_follower="+id);
			while (resultSet.next())
				{
				System.out.println("id: "+(int)resultSet.getObject("user_followed"));
				ResultSet resultSet2 = ddbb.selectQuery("SELECT * FROM playlists WHERE creator_user="+(int)resultSet.getObject("user_followed") +" AND publica = TRUE");
				resultSet2.next();
				Playlist playlist = new Playlist((int)resultSet.getObject("id_playlist"), (String)resultSet.getObject("name"), (String)resultSet2.getObject("user_name"));
				list.add(playlist);
				}
		
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
			return list;
	}
	
	public LinkedList<Object[]> getFollowedsDates(int id){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_follower="+id);
			while (resultSet.next())
				{
					for (int i = 0; i < userList.size(); i++){
						if (userList.get(i).getId() == resultSet.getInt(1)){
							Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
									userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
									totalSongs(userList.get(i).getId()),
									nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
							list.add(obj);
						}
		
					}
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	
	public LinkedList<Song> getSongs(){
		ResultSet resultSet = ddbb.selectQuery("SELECT * FROM songs");
		LinkedList<Song> list = new LinkedList<Song> (); 
		
		try{
			while (resultSet.next())
			{
				list.add(new Song ((int)resultSet.getObject("id_Song"), (String)resultSet.getObject("name"), 
						(String)resultSet.getObject("genre"), (String)resultSet.getObject("album"), (String)resultSet.getObject("artist"),
						(String)resultSet.getObject("location"), (int)resultSet.getObject("Stars"), (int)resultSet.getObject("reproducciones")));
			}	
		} catch (SQLException e) {
				// TODO Auto-generated catch block
			System.out.println("Error al recuperar las canciones de la base de datos");
		}
		return list;
	}
	
	public LinkedList<Song> getPlaylistSongs (int id){
		ResultSet resultSet = ddbb.selectQuery("SELECT cf_song FROM playlists_songs WHERE cf_playlist="+id);
		LinkedList<Song> list = new LinkedList<Song> (); 
		ResultSet resultSet1;
		
		try{
			while (resultSet.next())
			{
				resultSet1 = ddbb.selectQuery("SELECT * FROM songs WHERE id_song="+resultSet.getInt(1));
				while (resultSet1.next()){
					list.add(new Song ((int)resultSet1.getObject("id_Song"), (String)resultSet1.getObject("name"), 
						(String)resultSet1.getObject("genre"), (String)resultSet1.getObject("album"), (String)resultSet1.getObject("artist"),
						(String)resultSet1.getObject("location"), (int)resultSet1.getObject("Stars"), (int)resultSet1.getObject("reproducciones")));
				}
			}	
			
		} catch (SQLException e) {
				// TODO Auto-generated catch block
			System.out.println("Error al reperar las canciones de una playlist de la base de datos");
		}
		return list;
	}
	
	public String showPlaylitsUser(int id){
		String text = "";
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT name FROM playlists "
					+ "WHERE creator_user = "+id);
			while (resultSet.next())
				{
					text = text  + resultSet.getObject("name") + "\n";
				}	
					return text;
		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return "Problems";
		}
	}
	
	public void updateLastAccess (String username){
		ddbb.updateQuery("UPDATE users SET date_last_acces = now() WHERE user_name='"+username+"'");
	}
	
	
	public String addUser (String username, String password){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO users (user_name,password) VALUES ('"+username+"','"+password+"')");
				return ("Added");
			}
			
			else {
				return ("Username already exists");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
	
	public String deleteUser (String username){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			//Eliminar
			System.out.println("Eliminar->dontExit: "+dontExist);
			
			if (dontExist == 0){
				return ("Fail");
			}
			
			else {
				ResultSet consulta2 = ddbb.selectQuery("SELECT id_user FROM users WHERE user_name like '"+ username +"'");
				consulta2.next();
				int id = consulta2.getInt(1);
				//Eliminar
				System.out.println("Eliminar->id: "+id);
				ddbb.deleteQuery("DELETE FROM users WHERE user_name='"+username+"'");
				ddbb.deleteQuery("DELETE FROM followers WHERE user_follower="+id);
				ddbb.deleteQuery("DELETE FROM followers WHERE user_followed="+id);
				
				ResultSet consulta3 = ddbb.selectQuery("SELECT id_playlist FROM playlists WHERE creator_user ="+id);
				while (consulta3.next())
					{
					int list = consulta3.getInt(1);
					ddbb.deleteQuery("DELETE FROM playlist_songs WHERE cf_playlist="+list);
					}
				ddbb.deleteQuery("DELETE FROM playlists WHERE creator_user ="+id);
				return ("Deleted");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
	
	public String addSong(String name, String genre, String artist, String album, String location, int stars){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(name) FROM songs WHERE name like '"+ name +"' AND artist like '"+ artist+"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO songs (name, genre, album, location, artist, stars) VALUES ('"+name+"','"+genre+"','"+album+"','"+location+"','"+artist+"','"+stars+"')");
				return ("Add");
			}
			
			else {
				return ("Exists");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
	
	public String deleteSong (int idDelete){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(name) FROM songs WHERE id_song = "+idDelete);
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			
			if (dontExist == 0){
				return ("Fail");
			}
			
			else {
				//Eliminar
				System.out.println("Eliminar->id: "+idDelete);
				ddbb.deleteQuery("DELETE FROM playlists_songs WHERE cf_song="+idDelete);
				ddbb.deleteQuery("DELETE FROM songs WHERE id_song = "+idDelete);
				return ("Deleted");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}

	
	public int nFollowers(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_followed="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Problemas al obtener el numero de seguidores");
			return 0;
		}
	}
	
	public int nFolloweds(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_follower="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Problemas al obtener el numero de usuarios seguidos");
			return 0;
		}
	}
	
	public int nPlaylists(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM playlists WHERE creator_user="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Problemas al obtener el numero de playlists");
			return 0;
		}
	}
	
	public int nSongs (int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM playlists_songs WHERE cf_playlist="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Problemas al obtener el numero de canciones");
			return 0;
		}
	}
	
	public LinkedList<Object[]> getPlaylistsDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists WHERE creator_user="+id);
			while (resultSet.next())
				{
					String publica ="Publica";
					if ((int)resultSet.getObject("id_playlist") != 1){
						publica ="Privada";
					}
					Object[] obj = {(int)resultSet.getObject("id_playlist"),(String)resultSet.getObject("name"), nSongs((int)resultSet.getObject("id_playlist")), publica};
					list.add(obj);
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	public User getUser (int id){
		LinkedList<User> userList = getUsers();
		for (int i = 0; i<userList.size(); i++){
			if (userList.get(i).getId()==id){
				return userList.get(i);
			}
		}
		return null;
	}
	
	public int totalSongs (int id){
		int songs = 0;
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT id_playlist FROM playlists WHERE creator_user="+id);
			while(resultSet.next()){
				ResultSet resultSet2 = ddbb.selectQuery("SELECT count(*) FROM playlists_songs WHERE cf_playlist="+resultSet.getObject("id_playlist"));
				resultSet2.next();
				songs = songs + resultSet2.getInt(1);
			}
			return songs;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			System.out.println("Problemas al obtener el numero de usuarios seguidos");
			return 0;
		} catch (NullPointerException e){
			return 0;
		}
	}
}
=======
package database;

>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.LinkedList;

<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
import com.google.gson.JsonElement;

=======
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
import customExceptions.DatabaseNotLoadedException;
import model.Playlist;
import model.Song;
import model.User;

public class DDBBConnection {
	DataBase ddbb;
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

	/*
	 * Contructor que crea la clase DataBase que permite la conexiï¿½n y modificaciï¿½n con la base de datos.
=======
	
	/*
	 * Contructor que crea la clase DataBase que permite la conexión y modificación con la base de datos.
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	 */
	public DDBBConnection (String username, String password, String ddbbName, int port){
		ddbb = new DataBase(username, password, ddbbName, port);
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

	/*
	 * Conexiï¿½n con el servidor 
=======
	
	/*
	 * Conexión con el servidor 
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	 */
	public void startConnection() throws DatabaseNotLoadedException {
		ddbb.connect();
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	/*
	 * Desconexion con el servidor 
	 */
	public void stopConnection (){
		ddbb.disconnect();	
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

	/*
	 * Busca si el usuario existe en la base de datos y comprueba si la contraseï¿½a es correcta.
	 * Posibilidades: 
	 * 		"Incorrect username" -> Usuario no encontrado 
	 * 		"Welcome" -> Usuario enncontrado y la contraseï¿½a coincide
	 * 		"Incorrect password" -> Usuario encontrado pero la contraseï¿½ no coincide
=======
	
	/*
	 * Busca si el usuario existe en la base de datos y comprueba si la contraseña es correcta.
	 * Posibilidades: 
	 * 		"Incorrect username" -> Usuario no encontrado 
	 * 		"Welcome" -> Usuario enncontrado y la contraseña coincide
	 * 		"Incorrect password" -> Usuario encontrado pero la contraseá no coincide
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	 */
	public String userConnection(String username, String password){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			if (dontExist == 0 && !username.equals("username")){
				return "Incorrect username";
			}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			else {
				resultSet= ddbb.selectQuery("SELECT user_name, password FROM users WHERE user_name like '"+ username +"'");
				resultSet.next();
				if (password.equals(resultSet.getObject("password")) || password.equals("password")){
					updateLastAccess(username);
					return "Welcome";
				}
				else {
					return "Incorrect password";
				}
			}
		} catch (SQLException e) {
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			// TODO Auto-generated catch block
			return "Problems";
		}

	}

	/*
	 * Devuelve un String que todos los usuarios con sus respectivos datos
	 * Formato: Name/Fecha de registro/Fecha de la ï¿½ltima conexiï¿½n/contraseï¿½a
=======
				// TODO Auto-generated catch block
				return "Problems";
		}
		
	}
	
	/*
	 * Devuelve un String que todos los usuarios con sus respectivos datos
	 * Formato: Name/Fecha de registro/Fecha de la última conexión/contraseña
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	 */
	public LinkedList<User> getUsers(){
		ResultSet resultSet = ddbb.selectQuery("SELECT * FROM users");
		LinkedList<User> list = new LinkedList<User> ();
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

		try {
			//Recorrem el ResultSet que ens retorna el selectQuery i agafem els parï¿½metres desitjats
			while (resultSet.next())
			{
				//Per recuperar el valor utilitzem la funciï¿½ .getObject() amb el nom del camp a recuperar
				SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
				java.sql.Timestamp aux = (java.sql.Timestamp) resultSet.getObject("date_reg");
				String string  = dateFormat.format(aux);

				aux = (java.sql.Timestamp) resultSet.getObject("date_last_acces");
				String string2  = dateFormat.format(aux);

=======
		
		try {
			//Recorrem el ResultSet que ens retorna el selectQuery i agafem els paràmetres desitjats
			while (resultSet.next())
			{
			    //Per recuperar el valor utilitzem la funció .getObject() amb el nom del camp a recuperar
				SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
				java.sql.Timestamp aux = (java.sql.Timestamp) resultSet.getObject("date_reg");
				String string  = dateFormat.format(aux);
				
				aux = (java.sql.Timestamp) resultSet.getObject("date_last_acces");
				String string2  = dateFormat.format(aux);
				
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
				list.add(new User ((int)resultSet.getObject("id_user"), (String) resultSet.getObject("user_name"), string, string2, (String)resultSet.getObject("password")));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Error al recuperar los usuarios de la base de datos");
		}
		return list;
	}

=======
			System.out.println("Error al recuperar los usuarios de la base de datos");
		}
		return list;
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public LinkedList<Object[]> getUsersDates(){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list = new LinkedList<Object[]>();
		for (int i = 0; i < userList.size(); i++){
			Object[] objs = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
					userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
					totalSongs(userList.get(i).getId()),
					nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
=======
							userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
							totalSongs(userList.get(i).getId()),
							nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			list.add(objs);
		}
		return list;
	}

	public String getName(int id){
		LinkedList<User> userList = getUsers();
		for (int i = 0; i<userList.size(); i++){
			if (userList.get(i).getId()== id){
				return userList.get(i).getUsername();
			}
		}
		return "Desconocido";
	}

	public LinkedList<Object[]> getFollowersDates(int id){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list =new LinkedList<Object[]>();
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_followed="+id);
			while (resultSet.next())
			{
				for (int i = 0; i < userList.size(); i++){
					if (userList.get(i).getId() == resultSet.getInt(1)){
						Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
								userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
								totalSongs(userList.get(i).getId()),
								nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
						list.add(obj);
					}

				}
			}

			return list;

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
	}

	public LinkedList<Object[]> getPlaylistDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();

		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT (*) FROM playlists WHERE creato_user="+id);
			while (resultSet.next())
			{
				Object[] obj = {resultSet.getObject("id_playlist"), resultSet.getObject("name")};
				list.add(obj);

			}

			return list;

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
	}

	public int[] getSongsList(int id){
		LinkedList<Integer> list = new LinkedList<Integer>();
		int[] array = new int[]{};
		//int a[] = new int[a1.length+a2.length];

		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists_songs WHERE cf_playlist="+id);
			while (resultSet.next())
			{
				list.add((int)resultSet.getObject("cf_song"));
			}

			array = new int[list.size()];
			for (int i = 0; i<list.size(); i++){
				array[i] = list.get(i);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return array;
		}
		return array;

	}

=======
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_followed="+id);
			while (resultSet.next())
				{
					for (int i = 0; i < userList.size(); i++){
						if (userList.get(i).getId() == resultSet.getInt(1)){
							Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
									userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
									totalSongs(userList.get(i).getId()),
									nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
							list.add(obj);
						}
		
					}
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	public LinkedList<Object[]> getPlaylistDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT (*) FROM playlists WHERE creato_user="+id);
			while (resultSet.next())
				{
						Object[] obj = {resultSet.getObject("id_playlist"), resultSet.getObject("name")};
						list.add(obj);
		
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public LinkedList<Playlist> getPlaylists(){
		LinkedList<Playlist> list = new LinkedList<Playlist>();
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists");
			while (resultSet.next())
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			{
=======
				{
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
				ResultSet resultSet2 = ddbb.selectQuery("SELECT user_name FROM users WHERE id_user="+(int)resultSet.getObject("creator_user"));
				resultSet2.next();
				Playlist playlist = new Playlist((int)resultSet.getObject("id_playlist"), (String)resultSet.getObject("name"), (String)resultSet2.getObject("user_name"));
				list.add(playlist);
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			}

=======
				}
		
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
		return list;
	}

	public LinkedList<Playlist> getPublicPlaylists(int id){
		LinkedList<Playlist> list = new LinkedList<Playlist>();
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM followers WHERE user_follower="+id);
			while (resultSet.next())
			{
				ResultSet resultSet2 = ddbb.selectQuery("SELECT id_playlist, name, creator_user  FROM playlists WHERE publica = 1 AND creator_user="+(int)resultSet.getObject("user_followed"));

				while(resultSet2.next()){
					ResultSet resultSet3  = ddbb.selectQuery("SELECT user_name FROM users WHERE id_user="+(int)resultSet2.getObject("creator_user"));
					resultSet3.next();
					Playlist playlist = new Playlist((int)resultSet2.getObject("id_playlist"), (String)resultSet2.getObject("name"), (String)resultSet3.getObject("user_name"));
					list.add(playlist);
				}
			}

=======
			return list;
	}
	
	public LinkedList<Playlist> getPublicPlaylists(int id){
		LinkedList<Playlist> list = new LinkedList<Playlist>();
		try {
			System.out.println("id: "+id);
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM followers WHERE user_follower="+id);
			while (resultSet.next())
				{
				System.out.println("id: "+(int)resultSet.getObject("user_followed"));
				ResultSet resultSet2 = ddbb.selectQuery("SELECT * FROM playlists WHERE creator_user="+(int)resultSet.getObject("user_followed") +" AND publica = TRUE");
				resultSet2.next();
				Playlist playlist = new Playlist((int)resultSet.getObject("id_playlist"), (String)resultSet.getObject("name"), (String)resultSet2.getObject("user_name"));
				list.add(playlist);
				}
		
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
		return list;
	}

	public LinkedList<Object[]> getFollowedsDates(int id){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list =new LinkedList<Object[]>();

		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_follower="+id);
			while (resultSet.next())
			{
				for (int i = 0; i < userList.size(); i++){
					if (userList.get(i).getId() == resultSet.getInt(1)){
						Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
								userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
								totalSongs(userList.get(i).getId()),
								nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
						list.add(obj);
					}

				}
			}

			return list;

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
	}


	public LinkedList<Song> getSongs(){
		ResultSet resultSet = ddbb.selectQuery("SELECT * FROM songs");
		LinkedList<Song> list = new LinkedList<Song> (); 

=======
			return list;
	}
	
	public LinkedList<Object[]> getFollowedsDates(int id){
		LinkedList<User> userList = getUsers();
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT user_follower FROM followers WHERE user_follower="+id);
			while (resultSet.next())
				{
					for (int i = 0; i < userList.size(); i++){
						if (userList.get(i).getId() == resultSet.getInt(1)){
							Object[] obj = {userList.get(i).getId(), userList.get(i).getUsername(), userList.get(i).getRegistre(),
									userList.get(i).getLastAccess(), nPlaylists(userList.get(i).getId()),
									totalSongs(userList.get(i).getId()),
									nFollowers(userList.get(i).getId()), nFolloweds(userList.get(i).getId())};
							list.add(obj);
						}
		
					}
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
	
	public LinkedList<Song> getSongs(){
		ResultSet resultSet = ddbb.selectQuery("SELECT * FROM songs");
		LinkedList<Song> list = new LinkedList<Song> (); 
		
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
		try{
			while (resultSet.next())
			{
				list.add(new Song ((int)resultSet.getObject("id_Song"), (String)resultSet.getObject("name"), 
						(String)resultSet.getObject("genre"), (String)resultSet.getObject("album"), (String)resultSet.getObject("artist"),
						(String)resultSet.getObject("location"), (int)resultSet.getObject("Stars"), (int)resultSet.getObject("reproducciones")));
			}	
		} catch (SQLException e) {
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			// TODO Auto-generated catch block
			//System.out.println("Error al recuperar las canciones de la base de datos");
		}
		return list;
	}

=======
				// TODO Auto-generated catch block
			System.out.println("Error al recuperar las canciones de la base de datos");
		}
		return list;
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public LinkedList<Song> getPlaylistSongs (int id){
		ResultSet resultSet = ddbb.selectQuery("SELECT cf_song FROM playlists_songs WHERE cf_playlist="+id);
		LinkedList<Song> list = new LinkedList<Song> (); 
		ResultSet resultSet1;
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
		
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
		try{
			while (resultSet.next())
			{
				resultSet1 = ddbb.selectQuery("SELECT * FROM songs WHERE id_song="+resultSet.getInt(1));
				while (resultSet1.next()){
					list.add(new Song ((int)resultSet1.getObject("id_Song"), (String)resultSet1.getObject("name"), 
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
							(String)resultSet1.getObject("genre"), (String)resultSet1.getObject("album"), (String)resultSet1.getObject("artist"),
							(String)resultSet1.getObject("location"), (int)resultSet1.getObject("Stars"), (int)resultSet1.getObject("reproducciones")));
				}
			}	

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			//System.out.println("Error al reperar las canciones de una playlist de la base de datos");
		}
		return list;
	}

=======
						(String)resultSet1.getObject("genre"), (String)resultSet1.getObject("album"), (String)resultSet1.getObject("artist"),
						(String)resultSet1.getObject("location"), (int)resultSet1.getObject("Stars"), (int)resultSet1.getObject("reproducciones")));
				}
			}	
			
		} catch (SQLException e) {
				// TODO Auto-generated catch block
			System.out.println("Error al reperar las canciones de una playlist de la base de datos");
		}
		return list;
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public String showPlaylitsUser(int id){
		String text = "";
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT name FROM playlists "
					+ "WHERE creator_user = "+id);
			while (resultSet.next())
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			{
				text = text  + resultSet.getObject("name") + "\n";
			}	
			return text;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}

	public String addPlaylist (String name, int id, int publica){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(name) FROM playlists WHERE creator_user= "+id+" and name = '"+name+"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO playlists (creator_user, name, publica) VALUES ("+id+", '"+name+"', "+publica+")");
				return "Add";
			}

			return "Exit";
		}catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}

	public void updateLastAccess (String username){
		ddbb.updateQuery("UPDATE users SET date_last_acces = now() WHERE user_name='"+username+"'");
	}


=======
				{
					text = text  + resultSet.getObject("name") + "\n";
				}	
					return text;
		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return "Problems";
		}
	}
	
	public void updateLastAccess (String username){
		ddbb.updateQuery("UPDATE users SET date_last_acces = now() WHERE user_name='"+username+"'");
	}
	
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public String addUser (String username, String password){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO users (user_name,password) VALUES ('"+username+"','"+password+"')");
				return ("Added");
			}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			else {
				return ("Username already exists");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5





=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public String deleteUser (String username){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(user_name) FROM users WHERE user_name like '"+ username +"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			//Eliminar
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Eliminar->dontExit: "+dontExist);

			if (dontExist == 0){
				return ("Fail");
			}

=======
			System.out.println("Eliminar->dontExit: "+dontExist);
			
			if (dontExist == 0){
				return ("Fail");
			}
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			else {
				ResultSet consulta2 = ddbb.selectQuery("SELECT id_user FROM users WHERE user_name like '"+ username +"'");
				consulta2.next();
				int id = consulta2.getInt(1);
				//Eliminar
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
				//System.out.println("Eliminar->id: "+id);
				ddbb.deleteQuery("DELETE FROM users WHERE user_name='"+username+"'");
				ddbb.deleteQuery("DELETE FROM followers WHERE user_follower="+id);
				ddbb.deleteQuery("DELETE FROM followers WHERE user_followed="+id);

				ResultSet consulta3 = ddbb.selectQuery("SELECT id_playlist FROM playlists WHERE creator_user ="+id);
				while (consulta3.next())
				{
					int list = consulta3.getInt(1);
					ddbb.deleteQuery("DELETE FROM playlist_songs WHERE cf_playlist="+list);
				}
=======
				System.out.println("Eliminar->id: "+id);
				ddbb.deleteQuery("DELETE FROM users WHERE user_name='"+username+"'");
				ddbb.deleteQuery("DELETE FROM followers WHERE user_follower="+id);
				ddbb.deleteQuery("DELETE FROM followers WHERE user_followed="+id);
				
				ResultSet consulta3 = ddbb.selectQuery("SELECT id_playlist FROM playlists WHERE creator_user ="+id);
				while (consulta3.next())
					{
					int list = consulta3.getInt(1);
					ddbb.deleteQuery("DELETE FROM playlist_songs WHERE cf_playlist="+list);
					}
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
				ddbb.deleteQuery("DELETE FROM playlists WHERE creator_user ="+id);
				return ("Deleted");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public String addSong(String name, String genre, String artist, String album, String location, int stars){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(name) FROM songs WHERE name like '"+ name +"' AND artist like '"+ artist+"'");
			resultSet.next();
			int dontExist = resultSet.getInt(1);
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO songs (name, genre, album, location, artist, stars) VALUES ('"+name+"','"+genre+"','"+album+"','"+location+"','"+artist+"','"+stars+"')");
				return ("Add");
			}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
			
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			else {
				return ("Exists");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public String deleteSong (int idDelete){
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(name) FROM songs WHERE id_song = "+idDelete);
			resultSet.next();
			int dontExist = resultSet.getInt(1);
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

			if (dontExist == 0){
				return ("Fail");
			}

			else {
				//Eliminar
				//System.out.println("Eliminar->id: "+idDelete);
=======
			
			if (dontExist == 0){
				return ("Fail");
			}
			
			else {
				//Eliminar
				System.out.println("Eliminar->id: "+idDelete);
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
				ddbb.deleteQuery("DELETE FROM playlists_songs WHERE cf_song="+idDelete);
				ddbb.deleteQuery("DELETE FROM songs WHERE id_song = "+idDelete);
				return ("Deleted");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}

<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
	public String deletePlaylist( int idDeletePlaylist){
		//resultSet.next();
		ddbb.deleteQuery("DELETE FROM playlists_songs WHERE cf_playlist =" +idDeletePlaylist);
		ddbb.deleteQuery("DELETE FROM playlists WHERE id_playlist = " +idDeletePlaylist);
		return ("Deleted");
	}




=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public int nFollowers(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_followed="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Problemas al obtener el numero de seguidores");
			return 0;
		}
	}

=======
			System.out.println("Problemas al obtener el numero de seguidores");
			return 0;
		}
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public int nFolloweds(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_follower="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Problemas al obtener el numero de usuarios seguidos");
			return 0;
		}
	}

=======
			System.out.println("Problemas al obtener el numero de usuarios seguidos");
			return 0;
		}
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public int nPlaylists(int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM playlists WHERE creator_user="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Problemas al obtener el numero de playlists");
			return 0;
		}
	}

=======
			System.out.println("Problemas al obtener el numero de playlists");
			return 0;
		}
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public int nSongs (int id){
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM playlists_songs WHERE cf_playlist="+id);
			resultSet.next();
			return  resultSet.getInt(1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Problemas al obtener el numero de canciones");
			return 0;
		}
	}

	public LinkedList<Object[]> getPlaylistsDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();
		String publica; 
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists WHERE creator_user="+id);
			while (resultSet.next())
			{
				publica ="Privada";
				if ((boolean)resultSet.getObject("publica") == true){
					publica ="Publica";
				}
				Object[] obj = {(int)resultSet.getObject("id_playlist"),(String)resultSet.getObject("name"), nSongs((int)resultSet.getObject("id_playlist")), publica};
				list.add(obj);
			}

			return list;

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return list;
		}
	}

=======
			System.out.println("Problemas al obtener el numero de canciones");
			return 0;
		}
	}
	
	public LinkedList<Object[]> getPlaylistsDates(int id){
		LinkedList<Object[]> list =new LinkedList<Object[]>();
	
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT * FROM playlists WHERE creator_user="+id);
			while (resultSet.next())
				{
					String publica ="Publica";
					if ((int)resultSet.getObject("id_playlist") != 1){
						publica ="Privada";
					}
					Object[] obj = {(int)resultSet.getObject("id_playlist"),(String)resultSet.getObject("name"), nSongs((int)resultSet.getObject("id_playlist")), publica};
					list.add(obj);
				}
				
			return list;

		} catch (SQLException e) {
					// TODO Auto-generated catch block
			return list;
		}
	}
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public User getUser (int id){
		LinkedList<User> userList = getUsers();
		for (int i = 0; i<userList.size(); i++){
			if (userList.get(i).getId()==id){
				return userList.get(i);
			}
		}
		return null;
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

=======
	
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
	public int totalSongs (int id){
		int songs = 0;
		try{
			ResultSet resultSet = ddbb.selectQuery("SELECT id_playlist FROM playlists WHERE creator_user="+id);
			while(resultSet.next()){
				ResultSet resultSet2 = ddbb.selectQuery("SELECT count(*) FROM playlists_songs WHERE cf_playlist="+resultSet.getObject("id_playlist"));
				resultSet2.next();
				songs = songs + resultSet2.getInt(1);
			}
			return songs;
		} catch (SQLException e) {
			// TODO Auto-generated catch block
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5
			//System.out.println("Problemas al obtener el numero de usuarios seguidos");
=======
			System.out.println("Problemas al obtener el numero de usuarios seguidos");
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
			return 0;
		} catch (NullPointerException e){
			return 0;
		}
	}
<<<<<<< HEAD:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/78/1010f39e5420001617a7ffc84c1311d5

	public String follow(int idUser, int idFollowed) {
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_follower = "+ idUser +" AND user_followed= "+idFollowed);
			resultSet.next();
			int dontExist = resultSet.getInt(1);

			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO followers (user_follower,user_followed) VALUES ('"+idUser+"','"+idFollowed+"')");
				return ("Follow");
			}

			else {
				return ("Exist");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}

	public String unFollow(int idUser, int idFollowed) {
		try {
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM followers WHERE user_follower = "+ idUser +" AND user_followed= "+idFollowed);
			resultSet.next();
			int dontExist = resultSet.getInt(1);

			if (dontExist != 0){
				ddbb.deleteQuery("DELETE FROM followers WHERE user_follower =" +idUser+" AND user_followed="+idFollowed);
				return ("UnFollow");
			}

			else {
				return ("Dont");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}


	public String insertSongP(int idSong, int idPlaylist) {
		try {
			System.out.println("sfjsdlh.fhzgjalgnshglhglsdhf");
			ResultSet resultSet = ddbb.selectQuery("SELECT count(*) FROM playlists_songs WHERE cf_playlist = "+ idPlaylist +" AND cf_song= "+idSong);
			resultSet.next();
			int dontExist = resultSet.getInt(1);
			
			if (dontExist == 0){
				ddbb.insertQuery("INSERT INTO playlists_songs (cf_playlist ,cf_song) VALUES ('"+idPlaylist+"','"+idSong+"')");
				return ("Add");
			}
			
			else {
				return ("Exist");
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			return "Problems";
		}
	}	

	public int getIdUser(String name ) throws SQLException{
		ResultSet resultSet = ddbb.selectQuery("SElECT id FROM users where user_name = " +name);
		resultSet.next();
		return  resultSet.getInt(1);
	}

	public String reproducciones(int id) {
		ddbb.updateQuery("UPDATE songs SET reproducciones = reproducciones + 1 WHERE id_song");
		return null;
	}


}
=======
}
>>>>>>> 43c168751615550625957d287686bbb151ca0f40
>>>>>>> 1ff052d74203688313f619722ecffc77bffe868f:Eclipse/.metadata/.plugins/org.eclipse.core.resources/.history/3d/e0b9b2acb31f00161d68ac419788308c
